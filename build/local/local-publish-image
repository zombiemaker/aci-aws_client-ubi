#!/bin/bash
# The process that is executing this script must set the following env variables:
#   TGT_IMAGE_REPO_HOSTNAME
#   TGT_IMAGE_REPO_OWNERNAME
#   TGT_IMAGE_REPO_PASSWORD

source ./image-info

TGT_IMAGE_REPO_HOSTNAME=docker.io
TGT_IMAGE_REPO_OWNERNAME=zmaker123

#docker login --username ${TGT_IMAGE_REPO_OWNERNAME} --password ${TGT_IMAGE_REPO_PASSWORD} ${TGT_IMAGE_REPO_HOSTNAME}
# echo "docker tag ${IMAGE}:${IMAGE_TAG} ${TGT_IMAGE_REPO_HOSTNAME}/${TGT_IMAGE_REPO_OWNERNAME}/${IMAGE_REPO_NAME}:${IMAGE_TAG}"
# docker tag ${IMAGE}:${IMAGE_TAG} ${TGT_IMAGE_REPO_HOSTNAME}/${TGT_IMAGE_REPO_OWNERNAME}/${IMAGE_REPO_NAME}:${IMAGE_TAG}

echo "docker push ${TGT_IMAGE_REPO_HOSTNAME}/${TGT_IMAGE_REPO_OWNERNAME}/${IMAGE_REPO_NAME}:${IMAGE_TAG}"
docker push ${TGT_IMAGE_REPO_HOSTNAME}/${TGT_IMAGE_REPO_OWNERNAME}/${IMAGE_REPO_NAME}:${IMAGE_TAG}

# echo "docker tag ${TGT_IMAGE_REPO_HOSTNAME}/${TGT_IMAGE_REPO_OWNERNAME}/${IMAGE_REPO_NAME}:${IMAGE_TAG} ${TGT_IMAGE_REPO_HOSTNAME}/${TGT_IMAGE_REPO_OWNERNAME}/${IMAGE_REPO_NAME}:${IMAGE_TAG_LATEST}"
# docker tag ${TGT_IMAGE_REPO_HOSTNAME}/${TGT_IMAGE_REPO_OWNERNAME}/${IMAGE_REPO_NAME}:${IMAGE_TAG} ${TGT_IMAGE_REPO_HOSTNAME}/${TGT_IMAGE_REPO_OWNERNAME}/${IMAGE_REPO_NAME}:${IMAGE_TAG_LATEST}

echo "docker push ${TGT_IMAGE_REPO_HOSTNAME}/${TGT_IMAGE_REPO_OWNERNAME}/${IMAGE_REPO_NAME}:${IMAGE_TAG_LATEST}"
docker push ${TGT_IMAGE_REPO_HOSTNAME}/${TGT_IMAGE_REPO_OWNERNAME}/${IMAGE_REPO_NAME}:${IMAGE_TAG_LATEST}