#!/bin/bash

TARGET_REGISTRIES_INPUTFILE=target-registries

source ./image-info

while read -r TGT_IMAGE_REPO_HOSTNAME_OWNERNAME || [ -n "$TGT_IMAGE_REPO_HOSTNAME_OWNERNAME" ]
do
    echo "docker push ${TGT_IMAGE_REPO_HOSTNAME_OWNERNAME}/${IMAGE_REPO_NAME}:${IMAGE_TAG}"
    docker push ${TGT_IMAGE_REPO_HOSTNAME_OWNERNAME}/${IMAGE_REPO_NAME}:${IMAGE_TAG}

    echo "docker push ${TGT_IMAGE_REPO_HOSTNAME_OWNERNAME}/${IMAGE_REPO_NAME}:${IMAGE_TAG_LATEST}"
    docker push ${TGT_IMAGE_REPO_HOSTNAME_OWNERNAME}/${IMAGE_REPO_NAME}:${IMAGE_TAG_LATEST}

done < "$TARGET_REGISTRIES_INPUTFILE"